<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Memory Atlas</title>

  <link rel='stylesheet prefetch' href='https://fonts.googleapis.com/css?family=Open+Sans%3A300,400,600,700'>

  <link rel="stylesheet" href="css/style.css">

  <style>

    body {
      font-family: sans-serif;
    }

    ul#page_previews {
      list-style-type: none;
    }

    ul#page_previews li {
      float: left;
      background-color: #333;
      padding: 10px;
      margin: 10px;
      width: 200px;
    }

    ul#page_previews li a {
      display: inline-block;
      text-decoration: none;
      color: #eee;
    }

    </style>

</head>

<body>

  <ul id="page_previews">

    </ul>


  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js'></script>

  <script>

    function onPageData(data) {
      let title = data.ops[0].insert;
      let item = $(`<li><a href="/page.html?page_id=${data.page_id}">${title}</a></li>`);
      $('#page_previews').append(item);
    }

    function onPageListData(data) {
      
      data.result.forEach(function(entry) {
        let url = `/api.php?action=page&page_id=${entry.page_id}`;
        $.getJSON(url, onPageData);
      });

    }

    $.getJSON("/api.php?action=list", onPageListData);

  </script>

</body>

</html>